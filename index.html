<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QR Products - GitHub Pages</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<style>
body { background:#f8f9fa; }
.card { border-radius:15px; }
.qr-box {
  background:#fff;
  padding:10px;
  border-radius:10px;
  display:inline-block;
}
.link-box {
  font-size:12px;
  word-break: break-all;
  background:#f1f1f1;
  padding:6px;
  border-radius:6px;
}
</style>
</head>

<body>

<div class="container py-4">
  <h2 class="text-center mb-4">ðŸ“¦ Products QR Codes</h2>
  <div class="row" id="products"></div>
</div>

<script>
// =====================
// PRODUCTS DATA
// =====================
const products = [
  { id: 1, name: "Smart Watch", discount: "20%" },
  { id: 2, name: "Wireless Headphones", discount: "35%" },
  { id: 3, name: "Power Bank", discount: "15%" }
];

// =====================
// RENDER PRODUCTS
// =====================
const container = document.getElementById("products");

products.forEach(p => {

  // Ø±Ø§Ø¨Ø· Ø«Ø§Ø¨Øª Ù„ÙƒÙ„ Ù…Ù†ØªØ¬ Ø¹Ù„Ù‰ GitHub Pages
  const link = "/you/index.html?product=" + p.id;

  const col = document.createElement("div");
  col.className = "col-md-4 mb-4";

  col.innerHTML = `
    <div class="card shadow text-center p-3">
      <h5>${p.name}</h5>
      <p class="text-success fw-bold">Discount: ${p.discount}</p>

      <div class="qr-box my-2" id="qr-${p.id}"></div>

      <div class="link-box mt-2" id="link-${p.id}">
        ${link}
      </div>

      <div class="d-flex gap-2 justify-content-center mt-2">
        <button class="btn btn-outline-primary btn-sm"
          onclick="copyLink('${link}')">Copy Link</button>

        <button class="btn btn-outline-success btn-sm"
          onclick="downloadQR('qr-${p.id}', '${p.name}')">
          Download QR
        </button>
      </div>
    </div>
  `;

  container.appendChild(col);

  new QRCode(document.getElementById(`qr-${p.id}`), {
    text: link,
    width: 160,
    height: 160
  });
});

// =====================
// COPY LINK
// =====================
function copyLink(link) {
  navigator.clipboard.writeText(link);
  alert("Link copied!");
}

// =====================
// DOWNLOAD QR IMAGE
// =====================
function downloadQR(id, name) {
  const canvas = document.querySelector(`#${id} canvas`);
  const a = document.createElement("a");
  a.href = canvas.toDataURL("image/png");
  a.download = name.replace(/\s+/g, "_") + "_QR.png";
  a.click();
}

// =====================
// MOBILE VIEW WHEN SCANNED
// =====================
const params = new URLSearchParams(window.location.search);
const productId = params.get("product");

if (productId) {
  const product = products.find(p => p.id == productId);
  if (product) {
    document.body.innerHTML = `
      <div class="container d-flex justify-content-center align-items-center vh-100">
        <div class="card text-center p-4 shadow">
          <h3>${product.name}</h3>
          <h1 class="text-success">${product.discount} OFF</h1>
          <p class="text-muted">Show this screen to cashier</p>
        </div>
      </div>
    `;
  }
}
</script>

</body>
</html>
